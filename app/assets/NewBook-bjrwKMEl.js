import{d as g,u as B,f as w,r as c,w as y,g as h,c as t,B as S,S as I,a as F,i as N,an as _,ao as j,e as D}from"./index-DkYgaArx.js";import{B as R,s as q}from"./index-_EFv-KZk.js";import{a as C,B as E}from"./BasicTopBar-Dyq_xIRB.js";import{s as O}from"./utils-CaDVHRms.js";import"./vue-utils-FhOtgkxy.js";import"./InputGroup-afO5acjG.js";import"./Popover-JWH0sjZb.js";import"./get-T0yiJ2Om.js";import"./Image-DoGPqTRU.js";import"./create-D3Vn69pI.js";import"./FormItem-CVDvp3bR.js";import"./InputNumber-OnwWJcXs.js";import"./useTRouter-sTePj2MT.js";const V={"new-book":"_new-book_zpv31_1"};function x(a){return typeof a=="function"||Object.prototype.toString.call(a)==="[object Object]"&&!N(a)}const W=g({name:"NewBook",setup(){const{t:a}=B({useScope:"global"}),i=_(),f=j(),{message:l}=w(),u=c(),s=c();function b(){var r;const{cellId:o,bookcaseId:e}=i.query;(r=u.value)==null||r.getFormData().then(m=>{console.log(m);const d=m;if(d){if(typeof o!="string"||typeof e!="string")throw new Error("cellId and bookcaseId invalid");D.book.addBook(d,o,e).then(k=>{const{id:v}=k;f.replace({path:`/book/preview/id/${v}`})})}})}const n=c(!1);function p(o){return n.value=!0,q(o).catch(e=>{throw l.error(...O(o)),e}).finally(()=>{n.value=!1})}return y(()=>i.query,o=>{const e=o.isbn;e&&p(e).then(r=>{s.value={...r}}).catch(()=>{s.value={isbn:e}})},{immediate:!0}),h(()=>{l.destroyAll()}),()=>{let o;return t("div",{class:F(V["new-book"])},[t(C,{topBar:t(E,{rightSlots:[t(S,{onClick:b},{default:()=>[t(I,{name:"save"},null)]})]},x(o=a("pages.book.new.topbar.title"))?o:{default:()=>[o]})},{default:()=>[t(R,{ref:u,scraping:n.value,data:s.value,onScrape:p},null)]})])}}});export{W as default};
//# sourceMappingURL=NewBook-bjrwKMEl.js.map
