import{u as z}from"./useTRouter-DhKFTXki.js";import{d as N,t as F,u as y,c as e,a as V,s as j,r as p,o as T,b as q,e as d,B as h,S as k,i as O,f as P}from"./index-u1XP4khn.js";import{B as R,E as D}from"./BookcaseNameInput-DZPGpXXY.js";import{d as v,a as E}from"./constants-wS_ZPWmP.js";import{N as B,a as M}from"./FormItem-BkTTebpb.js";import{N as C}from"./InputNumber-BFJ5s627.js";import{B as U,a as A}from"./BasicTopBar-CdKwBE6F.js";import"./get-BewwGv1_.js";const L=N({name:"InitForm",props:{size:{type:Object,default:{width:v,height:v}},onChange:{type:Function}},setup(t){var i;const{size:n}=F(t),{t:c}=y({useScope:"global"});(i=t.onChange)==null||i.call(t,n.value);function r(o,s){var f;o!==null&&(n.value[s]=o,(f=t.onChange)==null||f.call(t,n.value))}return()=>e(M,{style:{marginTop:"24px"},inline:!0,labelPlacement:"left",model:n.value},{default:()=>[e(B,{label:c("common.width"),path:"width"},{default:()=>{var o;return[e(C,{placeholder:c("common.width"),buttonPlacement:"both",min:1,max:20,value:(o=n.value)==null?void 0:o.width,onUpdateValue:s=>r(s,"width")},null)]}}),e(B,{label:c("common.height"),path:"height"},{default:()=>{var o;return[e(C,{placeholder:c("common.height"),buttonPlacement:"both",min:1,max:20,value:(o=n.value)==null?void 0:o.height,onUpdateValue:s=>r(s,"height")},null)]}})]})}}),G="_title_1uqxc_6",H="_blur_1uqxc_13",u={"new-bookcase":"_new-bookcase_1uqxc_1",title:G,blur:H};function J(t){return typeof t=="function"||Object.prototype.toString.call(t)==="[object Object]"&&!O(t)}const te=N({name:"BookcaseNew",setup(){const{t}=y({useScope:"global"}),{router:n}=z(),{message:c,dialog:r}=V("top"),i=j(),o=p(""),s=p(),f=()=>{const{width:a=v,height:l=v}=s.value||{},I={...E,width:a,height:l},w=[];for(let b=0;b<a;b++)for(let g=0;g<l;g++)w.push({from:[b,g],to:[b+1,g+1],merge:!1});i.value={meta:I,cells:w}};T(()=>{r.create({title:t("pages.bookcase.newBookcase.initDialog.title"),closable:!1,maskClosable:!1,closeOnEsc:!1,content:()=>e(L,{size:s.value,onChange:a=>{s.value=a}},null),positiveText:t("common.confirm"),negativeText:t("common.forgetIt"),onPositiveClick(){f()},onNegativeClick(){n.back()}})}),q(()=>{r.destroyAll()});const m=p(),_=()=>{var a;(a=m.value)==null||a.mergeCells()},S=()=>{var a;(a=m.value)==null||a.breakCell()},x=()=>{var l;if(!o.value){c.error(t("pages.bookcase.newBookcase.bookcaseName.required"));return}const a=(l=m.value)==null?void 0:l.getData();P.bookcase.createNewBookcase({...a,name:o.value}).then(()=>{n.back()})};return()=>{let a;return e(A,{topBar:e(U,{rightSlots:[e(h,{onClick:x},{default:()=>[e(k,{name:"save"},null)]})]},J(a=t("pages.bookcase.newBookcase.topbar.title"))?a:{default:()=>[a]}),toolBar:[e(h,{class:d(u.blur),size:"large",circle:!0,strong:!0,tertiary:!0,onClick:()=>{var l;(l=m.value)==null||l.resetView()}},{default:()=>[e(k,{name:"restore"},null)]}),e(h,{class:d(u.blur),size:"large",circle:!0,strong:!0,tertiary:!0,onClick:_},{default:()=>[e(k,{name:"mergeCells"},null)]}),e(h,{class:d(u.blur),size:"large",circle:!0,strong:!0,tertiary:!0,onClick:S},{default:()=>[e(k,{name:"breakCells"},null)]})]},{default:()=>[e("div",{class:d(u["new-bookcase"])},[e("div",{class:d(u.title,u.blur)},[e(R,{isDual:"editonly",value:o.value,onChange:l=>{o.value=l}},null)]),e(D,{ref:m,data:i.value},null)])]})}}});export{te as default};
//# sourceMappingURL=NewBookcase-2G9E9bc7.js.map
