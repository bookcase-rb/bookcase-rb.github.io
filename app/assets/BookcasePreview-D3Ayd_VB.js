import{K as v,r as H}from"./constants-a1Lh4Cfi.js";import{d as K,t as N,u as O,r as g,w as P,c as o,e as b,f as U}from"./index-B9OrxFfD.js";const f={"bookcase-preview-container":"_bookcase-preview-container_1hd3b_1","bookcase-preview":"_bookcase-preview_1hd3b_1","bookcase-preview-image":"_bookcase-preview-image_1hd3b_16"},F=K({name:"BookcasePreview",props:{bookcaseId:{type:String,required:!1},selectedCellId:{type:String,required:!1},isLocated:{type:Boolean,default:!1},onSizeLoad:{type:Function,required:!1}},setup(s){const{bookcaseId:h,selectedCellId:p,isLocated:k}=N(s),{t:y}=O({useScope:"global"}),r=g();P(()=>h.value,a=>{a&&U.bookcase.queryBookcaseById(a).then(t=>{t&&(L(t),r.value=t.name)})},{immediate:!0});const d=g();function L(a){const{meta:t,cells:c}=a,{unit:e,fill:n,fillSelected:B}=t,I=(t.width*e||300)+4,S=(t.height*e||300)+4,m=new v.Stage({container:document.createElement("div"),x:2,y:2,width:I,height:S,draggable:!1}),u=new v.Layer;m.add(u),c.forEach(i=>{const{from:l,to:w,id:q}=i,E=l[0]*e,R=l[1]*e,x=(w[1]-l[1])*e,C=(w[0]-l[0])*e,z=new v.Rect({y:R,x:E,width:C,height:x,fill:q===p.value?B:n,cell:{...i},...H});u.add(z),u.draw()}),m.toBlob({}).then(i=>{d.value=i})}const _=a=>{var e,n;const c=(e=a.target.parentElement)==null?void 0:e.parentElement;(n=s.onSizeLoad)==null||n.call(s,c.clientWidth,c.clientHeight)};return()=>o("div",{class:b(f["bookcase-preview-container"])},[o("div",{class:b(f["bookcase-preview"])},[o("img",{class:b(f["bookcase-preview-image"]),src:d.value&&URL.createObjectURL(d.value),alt:r.value,onLoad:_},null),o("div",null,[o("span",null,[r.value]),o("span",null,[k.value?y("pages.bookcase.preview.current"):""])])])])}});export{F as B};
//# sourceMappingURL=BookcasePreview-D3Ayd_VB.js.map
