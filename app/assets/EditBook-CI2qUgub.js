import{d as b,u as v,a as y,r as n,w as g,b as h,c as t,B as S,S as c,f as u,e as D}from"./index-B6wo-CfO.js";import{u as F}from"./useTRouter-dMPEWueJ.js";import{B as I,s as C}from"./index-DshlJE3X.js";import{a as w,B as A}from"./BasicTopBar-CCdy-Rp6.js";import{D as E}from"./DeleteConfirmButton-D50TlYUg.js";import{s as q}from"./utils-BrL0SMRm.js";import"./vue-utils-D04Zu4M5.js";import"./InputGroup-Dk4cLsia.js";import"./Popover-DYnvKjhe.js";import"./get-PenFHmx_.js";import"./Image-Bty1mPYc.js";import"./create-D3Vn69pI.js";import"./FormItem-DK7FogUV.js";import"./InputNumber-CFVJwYlP.js";import"./Popconfirm-DiCRYgpg.js";const N={"edit-book":"_edit-book_166qk_1"},K=b({name:"EditBook",setup(){const{t:i}=v({useScope:"global"}),{route:m,router:d}=F(),{message:s}=y(),l=n(),r=n(),a=n(!1),p=o=>{a.value=!0,u.book.queryBookByBookId(o).then(e=>{e&&(r.value=e)}).finally(()=>{a.value=!1})};function f(o){return a.value=!0,(o?Promise.resolve(o):Promise.reject()).then(e=>C(e)).catch(e=>{throw s.error(...q()),e}).finally(()=>{a.value=!1})}g(()=>m.params.bookId,o=>{Array.isArray(o)||p(o)},{immediate:!0});function k(){var o;(o=l.value)==null||o.getFormData().then(e=>{const B=e;u.book.updateBook(B).then(()=>{s.success(i("pages.book.edit.saveSuccess"))})})}return h(()=>{s.destroyAll()}),()=>t("div",{class:D(N["edit-book"])},[t(w,{topBar:t(A,{rightSlots:[t(S,{onClick:k},{default:()=>[t(c,{name:"save"},null)]}),t(E,{onConfirm:()=>{var e;const o=(e=r.value)==null?void 0:e.id;o&&u.book.deleteBook(o).then(()=>{s.success(i("pages.book.edit.deleteSuccess")),d.back()})}},{default:()=>[t(c,{name:"delete"},null)]})]},{default:()=>{var o;return[((o=r.value)==null?void 0:o.title)||"-"]}})},{default:()=>[t(I,{ref:l,scraping:a.value,data:r.value,onScrape:f},null)]})])}});export{K as default};
//# sourceMappingURL=EditBook-CI2qUgub.js.map
