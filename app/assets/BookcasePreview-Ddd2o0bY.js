import{K as v,r as H}from"./constants-D8IofHZa.js";import{d as K,t as N,u as O,r as g,w as P,c as o,a as b,e as U}from"./index-DkYgaArx.js";const m={"bookcase-preview-container":"_bookcase-preview-container_1hd3b_1","bookcase-preview":"_bookcase-preview_1hd3b_1","bookcase-preview-image":"_bookcase-preview-image_1hd3b_16"},F=K({name:"BookcasePreview",props:{bookcaseId:{type:String,required:!1},selectedCellId:{type:String,required:!1},isLocated:{type:Boolean,default:!1},onSizeLoad:{type:Function,required:!1}},setup(s){const{bookcaseId:h,selectedCellId:p,isLocated:k}=N(s),{t:y}=O({useScope:"global"}),r=g();P(()=>h.value,t=>{t&&U.bookcase.queryBookcaseById(t).then(a=>{a&&(L(a),r.value=a.name)})},{immediate:!0});const d=g();function L(t){const{meta:a,cells:c}=t,{unit:e,fill:n,fillSelected:B}=a,I=(a.width*e||300)+4,S=(a.height*e||300)+4,f=new v.Stage({container:document.createElement("div"),x:2,y:2,width:I,height:S,draggable:!1}),u=new v.Layer;f.add(u),c.forEach(i=>{const{from:l,to:w,id:q}=i,E=l[0]*e,R=l[1]*e,x=(w[1]-l[1])*e,C=(w[0]-l[0])*e,z=new v.Rect({y:R,x:E,width:C,height:x,fill:q===p.value?B:n,cell:{...i},...H});u.add(z),u.draw()}),f.toBlob({}).then(i=>{d.value=i})}const _=t=>{var e,n;const c=(e=t.target.parentElement)==null?void 0:e.parentElement;(n=s.onSizeLoad)==null||n.call(s,c.clientWidth,c.clientHeight)};return()=>o("div",{class:b(m["bookcase-preview-container"])},[o("div",{class:b(m["bookcase-preview"])},[o("img",{class:b(m["bookcase-preview-image"]),src:d.value&&URL.createObjectURL(d.value),alt:r.value,onLoad:_},null),o("div",null,[o("span",null,[r.value]),o("span",null,[k.value?y("pages.bookcase.preview.current"):""])])])])}});export{F as B};
//# sourceMappingURL=BookcasePreview-Ddd2o0bY.js.map
